<h1 class="text-white text-center">Colaboradores disponibles</h1>

<section>
    @if (!isLoading()) {
    <div class="grid grid-cols-2 p-5 gap-x-5 sticky top-0">
        <button class="bg-blue-950 text-white p-1.5 rounded">Desmarcar todos</button>
        <app-modal-trigger modalId="collaboratorsModal" [class]="'bg-green-700 text-white rounded h-full w-full'">
            Elementos seleccionados {{collaboratorsControl.controls.length}}
        </app-modal-trigger>
    </div>

    <app-modal id="collaboratorsModal" title="Asignar colaboradores">
        <div [formGroup]="collaboratorsForm">
            <ul formArrayName="collaborators">
                @for (item of collaboratorsControl.controls; track $index; let i = $index) {
                <!-- Display data from abstract control or controls -->
                <collaborator-element [collaborator]="collaboratorsControl.at(i).value" />
                } @empty {
                    <p>Selecciona colaboradores primero</p>
                }
            </ul>
            
        </div>
    </app-modal>
    <ul class="gap-x-1">
        @for (collaborator of collaborators()?.data ?? []; track collaborator.id; let i = $index) {
        <li class="flex gap-x-5 gap-y mt-3 items-center hover:bg-neutral-800 p-1 rounded" #collaborator>
            <app-profile-image [name]="collaborator.name" />
            <div class="flex flex-col grow">
                <span class="font-semibold text-lg text-neutral-800 dark:text-white">{{collaborator.name}}</span>
                <span class="text-sm text-neutral-500 dark:text-neutral-400">{{collaborator.email}}</span>
            </div>
            <div>
                <div class="flex">
                    <label class="inline-flex items-center cursor-pointer group">
                        <input type="checkbox"
                            class="peer appearance-none w-5 h-5 border-2 border-gray-300 rounded-md bg-white checked:bg-blue-600 checked:border-blue-600 transition-all duration-200 focus:ring-2 focus:ring-blue-400 dark:bg-neutral-800 dark:border-neutral-700 dark:checked:bg-blue-500 dark:checked:border-blue-500"
                            id="hs-checked-checkbox" (change)="markCollaborator(collaborator, checkbox)" #checkbox>
                        <span class="absolute w-5 h-5 flex items-center justify-center pointer-events-none">
                            <svg class="opacity-0 peer-checked:opacity-100 transition-opacity duration-200 text-white"
                                width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M5 9l3 3 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                        </span>
                    </label>
                </div>
            </div>
        </li>
        } @empty {

        }
    </ul>
    } @else {
    <app-loader />
    }
</section>